<% if can? :create, Listing %>
To hire a worker, Click <%= link_to 'Here', new_listing_path %>
<% end %>
<br/>
<br/>

<div id="tag_cloud">
  <% tag_cloud Contractor.tag_counts, %w[s m l] do |tag, css_class| %>
    <%= link_to tag.name, tag_path(tag.name), class: css_class  %>
  <% end %>
</div>
<br>
<br>

<table>
  <thead>
    <tr>
      <th>Hourly Wage</th>
      <th>Certified</th>
      <th>Verified</th>
      <th>User</th>
      <th>Category</th>
      <th>Distance</th>
      <th>Expertise</th>
      <th colspan="7"></th>
    </tr>
  </thead>

  <tbody>
    <% @contractors.where(status: 'active').each do |contractor| %>
      <tr>
        <td>â‚¦<%= contractor.wage %></td>

        <% if contractor.status == 'active' %>
          <% if contractor.try(:certified) == true %>
          <td><%= image_tag 'green_tick.png' %></td>
          <% else %>
          <td><%= image_tag 'red_x.png' %></td> 
          <% end %>
        <% end %>

        <% if contractor.status == 'active' %>
          <% if contractor.try(:verified) == true %>
          <td><%= image_tag 'green_tick.png' %></td>
          <% else %>
          <td><%= image_tag 'red_x.png' %></td> 
          <% end %>
        <% end %>

    
          <%#= link_to contractor.try(:user).try(:first_name), user_path(contractor.try(:user))  %>gi

      
        <% if contractor.category != nil %>
        <td>
          <%= link_to contractor.category.name, category_path(contractor.category) %>
        </td>
        <% else %>
        <td> Not Listed</td>
        <% end %>

        <% if current_user.try(:geocoded?) %> 
          <td>
            <%= current_user.distance_from(contractor.user).round(2) %> miles away
          </td> 
        <% end %>

        <td><%= raw contractor.try(:tag_list).map {|t| link_to t, tag_path(t)}.join(', ') %></td>



        <% if can? :edit, contractor%>
        <td><%= link_to 'Edit', edit_contractor_path(contractor) %></td>
        <% end %>
        <% if can? :destroy, contractor %>
        <td><%= link_to 'Destroy', contractor, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>

<br>



