<% if can? :create, Listing %>
To hire a worker, Click <%= link_to 'Here', new_listing_path %>
<% end %>
<br/>
<br/>

<table>
  <thead>
    <tr>
      <th>Hourly Wage</th>
      <th>Certified</th>
      <th>Verified</th>
      <th>User</th>
      <th>Category</th>
      <th>Distance</th>
      <th colspan="6"></th>
    </tr>
  </thead>

  <tbody>
    <% @contractors.where(status: 'active').each do |contractor| %>
      <tr>
        <td>â‚¦<%= contractor.wage %></td>

        <% if contractor.status == 'active' %>
          <% if contractor.try(:certified) == true %>
          <td><%= image_tag 'green_tick.png' %></td>
          <% else %>
          <td><%= image_tag 'red_x.png' %></td> 
          <% end %>
        <% end %>

        <% if contractor.status == 'active' %>
          <% if contractor.try(:verified) == true %>
          <td><%= image_tag 'green_tick.png' %></td>
          <% else %>
          <td><%= image_tag 'red_x.png' %></td> 
          <% end %>
        <% end %>

    
        <td>  <%= link_to contractor.user.first_name, user_path(contractor.user)  %></td>

      
        <% if contractor.category != nil %>
        <td>
          <%= link_to contractor.category.name, category_path(contractor.category) %>
        </td>
        <% else %>
        <td> Not Listed</td>
        <% end %>

        <% if current_user.try(:geocoded?) %> 
          <td>
            <%= current_user.distance_from(contractor.user).round(2) %> miles away
          </td> 
        <% end %>



        <% if can? :edit, contractor%>
        <td><%= link_to 'Edit', edit_contractor_path(contractor) %></td>
        <% end %>
        <% if can? :destroy, contractor %>
        <td><%= link_to 'Destroy', contractor, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>

<br>



